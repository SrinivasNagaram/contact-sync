!function(e){"use strict";var t=e.module("MyContactsApp.dashboard",["ngRoute","ui.bootstrap","bsTable","blockUI","jcs-autoValidate","angularMask"]).config(["blockUIConfig","$routeProvider",function(e,t){e.autoBlock=!1,t.whenAuthenticated("/dashboard",{templateUrl:"account/dashboard/dashboard.html",controller:"DashboardCtrl",title:"My Contacts | Dashboard"}),t.whenAuthenticated("/dashboard/addcontact",{templateUrl:"account/dashboard/addcontact.html",controller:"DashboardCtrl",title:"My Contacts | Add Contact"})}]).controller("DashboardCtrl",["$rootScope","$scope","AllFriends","Auth","blockUI","Upload","$location","$routeParams","$timeout","$http","$filter",function(t,i,l,o,n,a,r,d,s,c,f){function g(){i.addedFriend=!1,i.deletetedFriendRecord=!1,i.updatedFriendRecord=!1}l[0]&&(i.google=l[0]),l[1]&&(i.facebook=l[1]),l[2]&&(i.twitter=l[2]),l[3]&&(i.linkedin=l[3]),l[4]&&(i.other=l[4]),i.addedFriend=!1,i.fallbackImg="assets/img/fallbackImg.jpg",i.showFriendModal=!1,i.deleteFriend=!1,i.otherProfileUrl=!0,i.hasUserMsg=!1;var u=n.instances.get("loadFriends");u.start("Loading contacts list"),i.userURL=function(t){i.value={},t&&(e.forEach(i.linkedin,function(e){i.value=e.profileurl,i.value===t.profileurl?i.hasUserMsg=!0:i.hasUserMsg=!1}),e.forEach(i.facebook,function(e){i.value=e.profileurl,i.value===t.profileurl&&(i.hasUserMsg=!0)}),e.forEach(i.twitter,function(e){i.value=e.profileurl,i.value===t.profileurl&&(i.hasUserMsg=!0)}),e.forEach(i.google,function(e){i.value=e.profileurl,i.value===t.profileurl&&(i.hasUserMsg=!0)}),e.forEach(i.other,function(e){i.value=e.email,i.value===t.email&&(i.hasUserMsg=!0)}))},i.userPhone=function(e){i.phonetype=e.phonetype},i.otherOption=function(e){i.value={},"other"===e.category?i.otherProfileUrl=!1:i.otherProfileUrl=!0},i.addFriends=function(e){a.base64DataUrl(e.profilePic).then(function(t){i.friendsObj={firstname:e.firstname||null,lastname:e.lastname||null,title:e.title||null,email:e.email||null,phone:e.phone||null,phonetype:e.phonetype||null,profileurl:e.profileurl||null,profilepic:t[0]||i.fallbackImg},"linkedin"===e.category&&(i.submitting=!0,i.linkedin.$add(i.friendsObj).then(function(e){i.addedFriend=!0,i.submitting=!1,s(g,3e3)})),"facebook"===e.category&&(i.submitting=!0,i.facebook.$add(i.friendsObj).then(function(e){i.addedFriend=!0,i.submitting=!1,s(g,3e3)})),"twitter"===e.category&&(i.submitting=!0,i.twitter.$add(i.friendsObj).then(function(e){i.addedFriend=!0,i.submitting=!1,s(g,3e3)})),"google"===e.category&&(i.submitting=!0,i.google.$add(i.friendsObj).then(function(e){i.addedFriend=!0,i.submitting=!1,s(g,3e3)})),"other"===e.category&&(i.submitting=!0,i.other.$add(i.friendsObj).then(function(e){i.addedFriend=!0,i.submitting=!1,s(g,3e3)}))})},i.reset=function(e){e={}||null,e.profilePic=[]},i.lfriends=!1,i.linkedin.$loaded().then(function(e){void 0===e[0]&&(i.lTable=!1,i.lfriends=!0),void 0!==e[0]&&(i.lTable=!0,i.linkedinFriendsList=[],i.linkedinFriendsList.push({}),i.linkedinFriendsList.forEach(function(t){function l(e,t,i){return'<a href="'+t.profileurl+'" target="_blank"><i class="fa fa-linkedin-square"></i></a>'}function o(e,t,i){return'<img src="'+t.profilepic+'" alt="'+t.firstname+'" width="35" height="35"/>'}function n(e,t,i){return['<a class="editFriend btn btn-info btn-xs" ><i class="glyphicon glyphicon-pencil"></i></a>','<a class="deleteFriend btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i></a>'].join("")}t.bsTableControl={options:{data:e,cache:!1,striped:!0,pagination:!0,paginationVAlign:"both",pageSize:25,pageList:[25,50,100,200],search:!0,showColumns:!0,showRefresh:!1,minimumCountColumns:2,clickToSelect:!1,showToggle:!0,maintainSelected:!0,columns:[{field:"firstname",title:"First Name",align:"left",valign:"bottom",sortable:!0},{field:"lastname",title:"Last Name",align:"left",valign:"bottom",sortable:!0},{field:"title",title:"Title",align:"left",valign:"bottom",sortable:!0},{field:"email",title:"Email Address",align:"left",valign:"bottom",sortable:!0},{field:"phone",title:"Phone",align:"left",valign:"bottom",sortable:!0},{field:"profileurl",title:"Google Plus",align:"left",valign:"bottom",clickToSelect:!1,formatter:l},{field:"profilepic",title:"Picture",align:"left",valign:"bottom",clickToSelect:!1,formatter:o},{field:"actions",title:"Actions",align:"left",valign:"bottom",events:i.curdLinkedInEvents,formatter:n}]}},i.curdLinkedInEvents={"click .editFriend":function(e,t,l,o){$("#otherProfileUrlPopup").show(),$("#showFriendModal").modal("show"),i.linkedin.$getRecord(l.$id)&&(i.categoryId=i.linkedin.$getRecord(l.$id),i.category=i.linkedin,$("#friendFristName").val(l.firstname),$("#friendLastName").val(l.lastname),$("#friendTitle").val(l.title),$("#friendEmail").val(l.email),$("#friendPhone").val(l.phone),$("#friendProfileURL").val(l.profileurl))},"click .deleteFriend":function(e,t,l,o){var n=i.linkedin.$getRecord(l.$id);0===o&&($("#deleteFriendPopup").modal("hide"),alert("Please keep one friend")),0!==o&&$("#deleteFriendPopup").modal("show"),$("#cencelDelete").on("click",function(){$("#deleteFriendPopup").modal("hide")}),$("#deleteFriendRecord").on("click",function(){o>0&&(i.linkedin.$remove(n),$("#deleteFriendPopup").modal("hide"),i.deletetedFriendRecord=!0,s(g,2e3))})}}})),s(function(){u.stop()})}),i.fbfriends=!1,i.facebook.$loaded().then(function(e){void 0===e[0]&&(i.fbTable=!1,i.fbfriends=!0),void 0!==e[0]&&(i.fbTable=!0,i.facebookFriendsList=[],i.facebookFriendsList.push({}),i.facebookFriendsList.forEach(function(t){function l(e,t,i){return'<a href="'+t.profileurl+'" target="_blank"><i class="fa fa-facebook-official"></i></a>'}function o(e,t,i){return'<img src="'+t.profilepic+'" alt="'+t.firstname+'" width="35" height="35"/>'}function n(e,t,i){return['<a class="editFriend btn btn-info btn-xs" ><i class="glyphicon glyphicon-pencil"></i></a>','<a class="deleteFriend btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i></a>'].join("")}t.bsTableControl={options:{data:e,cache:!1,striped:!0,pagination:!0,paginationVAlign:"both",pageSize:25,pageList:[25,50,100,200],search:!0,showColumns:!0,showRefresh:!1,minimumCountColumns:2,clickToSelect:!1,showToggle:!0,maintainSelected:!0,columns:[{field:"firstname",title:"First Name",align:"left",valign:"bottom",sortable:!0},{field:"lastname",title:"Last Name",align:"left",valign:"bottom",sortable:!0},{field:"title",title:"Title",align:"left",valign:"bottom",sortable:!0},{field:"email",title:"Email Address",align:"left",valign:"bottom",sortable:!0},{field:"phone",title:"Phone",align:"left",valign:"bottom",sortable:!0},{field:"profileurl",title:"Google Plus",align:"left",valign:"bottom",clickToSelect:!1,formatter:l},{field:"profilepic",title:"Picture",align:"left",valign:"bottom",clickToSelect:!1,formatter:o},{field:"actions",title:"Actions",align:"left",valign:"bottom",events:i.curdFacebookEvents,formatter:n}]}},i.curdFacebookEvents={"click .editFriend":function(e,t,l,o){$("#otherProfileUrlPopup").show(),$("#showFriendModal").modal("show"),i.facebook.$getRecord(l.$id)&&(i.categoryId=i.facebook.$getRecord(l.$id),i.category=i.facebook,$("#friendFristName").val(l.firstname),$("#friendLastName").val(l.lastname),$("#friendTitle").val(l.title),$("#friendEmail").val(l.email),$("#friendPhone").val(l.phone),$("#friendProfileURL").val(l.profileurl))},"click .deleteFriend":function(e,t,l,o){var n=i.facebook.$getRecord(l.$id);0===o&&($("#deleteFriendPopup").modal("hide"),alert("Please keep one friend")),0!==o&&$("#deleteFriendPopup").modal("show"),$("#cencelDelete").on("click",function(){$("#deleteFriendPopup").modal("hide")}),$("#deleteFriendRecord").on("click",function(){o>0&&(i.facebook.$remove(n),$("#deleteFriendPopup").modal("hide"),i.deletetedFriendRecord=!0,s(g,2e3))})}}}))}),i.tfriends=!1,i.twitter.$loaded().then(function(e){void 0===e[0]&&(i.tTable=!1,i.tfriends=!0),void 0!==e[0]&&(i.tTable=!0,i.twitterFriendsList=[],i.twitterFriendsList.push({}),i.twitterFriendsList.forEach(function(t){function l(e,t,i){return'<a href="'+t.profileurl+'" target="_blank"><i class="fa fa-twitter-square"></i></a>'}function o(e,t,i){return'<img src="'+t.profilepic+'" alt="'+t.firstname+'" width="35" height="35"/>'}function n(e,t,i){return['<a class="editFriend btn btn-info btn-xs" ><i class="glyphicon glyphicon-pencil"></i></a>','<a class="deleteFriend btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i></a>'].join("")}t.bsTableControl={options:{data:e,cache:!1,striped:!0,pagination:!0,paginationVAlign:"both",pageSize:25,pageList:[25,50,100,200],search:!0,showColumns:!0,showRefresh:!1,minimumCountColumns:2,clickToSelect:!1,showToggle:!0,maintainSelected:!0,columns:[{field:"firstname",title:"First Name",align:"left",valign:"bottom",sortable:!0},{field:"lastname",title:"Last Name",align:"left",valign:"bottom",sortable:!0},{field:"title",title:"Title",align:"left",valign:"bottom",sortable:!0},{field:"email",title:"Email Address",align:"left",valign:"bottom",sortable:!0},{field:"phone",title:"Phone",align:"left",valign:"bottom",sortable:!0},{field:"profileurl",title:"Google Plus",align:"left",valign:"bottom",clickToSelect:!1,formatter:l},{field:"profilepic",title:"Picture",align:"left",valign:"bottom",clickToSelect:!1,formatter:o},{field:"actions",title:"Actions",align:"left",valign:"bottom",events:i.curdTwitterEvents,formatter:n}]}},i.curdTwitterEvents={"click .editFriend":function(e,t,l,o){$("#otherProfileUrlPopup").show(),$("#showFriendModal").modal("show"),i.twitter.$getRecord(l.$id)&&(i.categoryId=i.twitter.$getRecord(l.$id),i.category=i.twitter,$("#friendFristName").val(l.firstname),$("#friendLastName").val(l.lastname),$("#friendTitle").val(l.title),$("#friendEmail").val(l.email),$("#friendPhone").val(l.phone),$("#friendProfileURL").val(l.profileurl))},"click .deleteFriend":function(e,t,l,o){var n=i.twitter.$getRecord(l.$id);0===o&&($("#deleteFriendPopup").modal("hide"),alert("Please keep one friend")),0!==o&&$("#deleteFriendPopup").modal("show"),$("#cencelDelete").on("click",function(){$("#deleteFriendPopup").modal("hide")}),$("#deleteFriendRecord").on("click",function(){o>0&&(i.twitter.$remove(n),$("#deleteFriendPopup").modal("hide"),i.deletetedFriendRecord=!0,s(g,2e3))})}}}))}),i.gfriends=!1,i.google.$loaded().then(function(e){void 0===e[0]&&(i.gTable=!1,i.gfriends=!0),void 0!==e[0]&&(i.gTable=!0,i.googleFriendsList=[],i.googleFriendsList.push({}),i.googleFriendsList.forEach(function(t){function l(e,t,i){return'<a href="'+t.profileurl+'" target="_blank"><i class="fa fa-google-plus-square"></i></a>'}function o(e,t,i){return'<img src="'+t.profilepic+'" alt="'+t.firstname+'" width="35" height="35"/>'}function n(e,t,i){return['<a class="editFriend btn btn-info btn-xs"><i class="glyphicon glyphicon-pencil"></i></a>','<a class="deleteFriend btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i></a>'].join("")}t.bsTableControl={options:{data:e,cache:!1,striped:!0,pagination:!0,paginationVAlign:"both",pageSize:25,pageList:[25,50,100,200],search:!0,showColumns:!0,showRefresh:!1,minimumCountColumns:2,clickToSelect:!1,showToggle:!0,maintainSelected:!0,columns:[{field:"firstname",title:"First Name",align:"left",valign:"bottom",sortable:!0},{field:"lastname",title:"Last Name",align:"left",valign:"bottom",sortable:!0},{field:"title",title:"Title",align:"left",valign:"bottom",sortable:!0},{field:"email",title:"Email Address",align:"left",valign:"bottom",sortable:!0},{field:"phone",title:"Phone",align:"left",valign:"bottom",sortable:!0},{field:"profileurl",title:"Google Plus",align:"left",valign:"bottom",clickToSelect:!1,formatter:l},{field:"profilepic",title:"Picture",align:"left",valign:"bottom",clickToSelect:!1,formatter:o},{field:"actions",title:"Actions",align:"left",valign:"bottom",events:i.curdGoogleEvents,formatter:n}]}},i.curdGoogleEvents={"click .editFriend":function(e,t,l,o){$("#otherProfileUrlPopup").show(),$("#showFriendModal").modal("show"),i.google.$getRecord(l.$id)&&(i.categoryId=i.google.$getRecord(l.$id),i.category=i.google,$("#friendFristName").val(l.firstname),$("#friendLastName").val(l.lastname),$("#friendTitle").val(l.title),$("#friendEmail").val(l.email),$("#friendPhone").val(l.phone),$("#friendProfileURL").val(l.profileurl))},"click .deleteFriend":function(e,t,l,o){var n=i.google.$getRecord(l.$id);0===o&&($("#deleteFriendPopup").modal("hide"),alert("Please keep one friend")),0!==o&&$("#deleteFriendPopup").modal("show"),$("#cencelDelete").on("click",function(){$("#deleteFriendPopup").modal("hide")}),$("#deleteFriendRecord").on("click",function(){o>0&&(i.google.$remove(n),$("#deleteFriendPopup").modal("hide"),i.deletetedFriendRecord=!0,s(g,2e3))})}}}))}),i.ofriends=!1,i.other.$loaded().then(function(e){void 0===e[0]&&(i.oTable=!1,i.ofriends=!0),void 0!==e[0]&&(i.oTable=!0,i.otherFriendsList=[],i.otherFriendsList.push({}),i.otherFriendsList.forEach(function(t){function l(e,t,i){return'<img src="'+t.profilepic+'" alt="'+t.firstname+'" width="35" height="35"/>'}function o(e,t,i){return['<a class="editFriend btn btn-info btn-xs"><i class="glyphicon glyphicon-pencil"></i></a>','<a class="deleteFriend btn btn-danger btn-xs"><i class="glyphicon glyphicon-trash"></i></a>'].join("")}t.bsTableControl={options:{data:e,cache:!1,striped:!0,pagination:!0,paginationVAlign:"both",pageSize:25,pageList:[25,50,100,200],search:!0,showColumns:!0,showRefresh:!1,minimumCountColumns:2,clickToSelect:!1,showToggle:!0,maintainSelected:!0,columns:[{field:"firstname",title:"First Name",align:"left",valign:"bottom",sortable:!0},{field:"lastname",title:"Last Name",align:"left",valign:"bottom",sortable:!0},{field:"title",title:"Title",align:"left",valign:"bottom",sortable:!0},{field:"email",title:"Email Address",align:"left",valign:"bottom",sortable:!0},{field:"phone",title:"Phone",align:"left",valign:"bottom",sortable:!0},{field:"profilepic",title:"Picture",align:"left",valign:"bottom",clickToSelect:!1,formatter:l},{field:"actions",title:"Actions",align:"left",valign:"bottom",events:i.curdOtherEvents,formatter:o}]}},i.curdOtherEvents={"click .editFriend":function(e,t,l,o){void 0===l.profileurl&&$("#otherProfileUrlPopup").hide(),$("#showFriendModal").modal("show"),i.other.$getRecord(l.$id)&&(i.categoryId=i.other.$getRecord(l.$id),i.category=i.other,$("#friendFristName").val(l.firstname),$("#friendLastName").val(l.lastname),$("#friendTitle").val(l.title),$("#friendEmail").val(l.email),$("#friendPhone").val(l.phone))},"click .deleteFriend":function(e,t,l,o){var n=i.other.$getRecord(l.$id);0===o&&($("#deleteFriendPopup").modal("hide"),alert("Please keep one friend")),0!==o&&$("#deleteFriendPopup").modal("show"),$("#cencelDelete").on("click",function(){$("#deleteFriendPopup").modal("hide")}),$("#deleteFriendRecord").on("click",function(){o>0&&(i.other.$remove(n),$("#deleteFriendPopup").modal("hide"),i.deletetedFriendRecord=!0,s(g,2e3))})}}}))}),i.showFriend=function(e,t,l){l.$getRecord(t.$id)&&(i.categoryId=l.$getRecord(t.$id),i.category=l,i.friend={firstname:t.firstname,lastname:t.lastname,title:t.title,email:t.email,phone:t.phone,profileurl:t.profileurl,profilepic:t.profilepic})},i.fileNameChanged=function(){var e=document.querySelector("input[type=file]").files[0],t=new FileReader;t.addEventListener("load",function(){i.url=t.result},!1),e&&t.readAsDataURL(e)},i.editFriend=function(e,t){$("#editFriendForm").validate(),e.firstname=$("#friendFristName").val(),e.lastname=$("#friendLastName").val(),e.title=$("#friendTitle").val(),e.email=$("#friendEmail").val(),e.phone=$("#friendPhone").val(),e.profileurl=$("#friendProfileURL").val(),e.profilepic=i.url||e.profilepic,i.category.$save(e),i.showFriendModal=!1,i.updatedFriendRecord=!0,s(g,2e3)}}]);t.controller("TabController",["$scope",function(e){this.tab=1,this.selectTab=function(e){this.tab=e},this.isSelected=function(e){return this.tab===e}}])}(angular);