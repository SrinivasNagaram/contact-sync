!function(e){"use strict";var n=e.module("MyContactsApp.account",["firebase","firebase.utils","firebase.auth","ngRoute","ngFileUpload","jcs-autoValidate"]);n.controller("AccountCtrl",["$rootScope","$scope","Upload","Auth","fbutil","user","$location","$firebaseObject","$timeout",function(e,n,o,a,i,r,t,l,c){function s(){n.nameMsg=!1,n.err=!1,n.emailerr=!1,n.emailmsg=!1,n.msg=!1}function u(){n.err=null,n.msg=null,n.emailerr=null,n.emailmsg=null}var m,d=l(i.ref("users",r.uid));d.$bindTo(n,"profile").then(function(e){m=e}),n.updateProfile=function(e){void 0!==e&&(void 0!==e.profilePics&&o.base64DataUrl(e.profilePics).then(function(e){n.profile.profilepic=e[0],n.nameMsg="Your picture is changed"}),void 0!==e.newName&&(n.profile.name=e.newName,n.nameMsg="Your name is changed"),void 0!==e.company&&(n.profile.company=e.company,n.nameMsg="Your company is changed")),c(s,3e3)},n.changePassword=function(e,o,i){u(),e&&o&&i?i!==o?n.err="Passwords do not match":a.$changePassword({email:d.email,oldPassword:e,newPassword:i}).then(function(){n.msg="Password is Changed"},function(e){"INVALID_PASSWORD"===e.code&&(n.err="Invalid Old Password")}):n.err=!1,c(s,3e3)},n.clear=u,n.changeEmail=function(e,o){u();var t=d.email;a.$changeEmail({oldEmail:t,newEmail:o,password:e}).then(function(){return i.handler(function(e){i.ref("users",r.uid,"email").set(o,e)})}).then(function(){n.emailmsg="Email is Changed"},function(e){"INVALID_PASSWORD"===e.code&&(n.emailerr="Invalid Password")}),c(s,3e3)}}]),n.config(["$routeProvider",function(e){e.whenAuthenticated("/account",{templateUrl:"account/profile/profile.html",controller:"AccountCtrl",title:"My Contacts | Profile"})}])}(angular);